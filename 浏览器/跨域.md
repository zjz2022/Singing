跨域问题 跨域的场景下一个接口会发送几次请求 预检请求？

## 跨域（3.18腾讯云智一面）

### 跨域的含义及解决方案

在Web开发中，跨域表示的是从一个域的网页去请求另一个域的资源。由于浏览器同源策略的限制，一个域的网页无法访问或对另一个域的资源进行操作（包括Ajax请求），这就是所谓的跨域问题。

这里的“域”指的是协议、主机和端口的组合。只有这三者完全相同，才算作同一来源。例如 http://www.example.com 与 https://www.example.com（协议不同）或 http://www.example.com 与 http://blog.example.com（主机不同）或 http://www.example.com:8080 和 http://www.example.com:9090（端口不同）都被认为是不同的源。

然而，在实际开发中，有些情况需要进行跨域访问，例如使用Ajax从一个网站请求另一个网站的API。这时，我们可以使用以下主要技术来解决跨域问题：

1. CORS（Cross-Origin Resource Sharing, 跨源资源共享）：这是最主流的跨域方案，通过服务器端设置Access-Control-Allow-Origin来允许哪些源可以进行跨域访问。服务器还可以设置其他的一些CORS头部字段，如Access-Control-Allow-Methods，Access-Control-Allow-Headers等对跨域请求进行更细致的控制。

2. JSONP（JSON with Padding）：这种方式是通过动态插入<script>标签调用服务端提供的带回调函数的JavaScript代码。由于<script>标签的src属性请求的资源不会被同源策略限制，所以可以用来进行跨域请求。但是，JSONP只能发送GET请求，并且安全性相比CORS要差一些。

3. 使用代理服务器：如果前端和后端在同一台服务器上，可以设置服务器端去请求另一个源的资源，然后将获取的资源返回给前端，从而绕过浏览器的同源策略。

4. 使用WebSockets：WebSockets不受同源策略限制，可以用来进行跨域通信。

5. 使用postMessage：这是HTML5引入的一个新API，可以实现跨窗口通信，不受同源策略的限制。

根据具体的项目需求和环境，可以选择合适的跨域解决方案。

### 浏览器跨域是怎么产生的，怎么解决？

浏览器的跨域问题主要是由于浏览器的同源策略造成的。同源策略是浏览器的一种安全机制，它规定只有当协议、主机、端口号完全相同的两个页面，才能共享彼此的资源。这样做可以有效地防止某些恶意站点利用脚本窃取用户信息。

然而，在实际的Web开发中，我们有时需要访问不同源的资源，例如使用Ajax从一个网站请求另一个网站的API。这时，浏览器的同源策略就会成为一个问题，因为它阻止了这种跨域请求。

解决浏览器跨域问题的主要方法包括：

1. CORS（跨源资源共享）：CORS 是最常见的一种解决跨域的方法。在实现 CORS 时，服务器需要在响应头中加入Access-Control-Allow-Origin字段，确定哪些来源可以访问其资源。

2. JSONP（JSON with Padding）：JSONP 方法是通过动态添加<script>标签的方式来进行跨域请求。服务器返回的数据通过回调函数进行处理，这样就可以绕过同源策略的限制。但是，JSONP 只支持 GET 请求，并且安全性不如 CORS。

3. 服务器端代理：这种方法是在服务器端设置一个代理，将前端的请求转发到其他服务器上，然后将返回的数据再传给前端，从而绕开同源策略的限制。

4. 使用WebSockets：WebSockets 是一种网络协议，它不受同源策略的限制，可以用来实现跨域通信。

5. PostMessage API：PostMessage 是 HTML5 提供的一种通信方法，允许跨窗口、跨文档、跨源实现数据交换。

需要注意的是，选择哪种跨域解决方案，需要根据项目具体需求和实际环境来决定。

### 为什么APP没有跨域问题？

- APP有同源策略吗？没有，因为只有浏览器有

### 跨域在其他场景有使用吗？比如localStorage？Cookie呢？三级域名可以共享吗？

跨域问题与解决方案