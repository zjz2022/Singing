# 登录注册

## 登录是怎么做的，jwt 相关，以及 cookie，session 相关，太细啦！

用户登录成功后，服务器端会使用用户信息，加上一个密钥生成 JWT 令牌，然后将这个令牌发给客户端。客户端收到令牌后，可以把它存储在本地（例如 localStorage 或 cookies）然后每次向服务器发送请求时，都带上这个令牌。服务器收到这个令牌后，会用之前的密钥去解码，如果能正确解出用户信息，那说明这个 JWT 是合法未被篡改的，用户是已登录状态。

## 除了用 jwt 还有其他方案嘛

除了 JWT，还有 sessioncookie 验证方式。这种方式用户登录成功后，服务器会生成一个 session ID 然后发给客户端，客户端将 session ID 存储在 cookie 中，之后每次发起请求，都会带上这个 session ID。

## 登陆注册怎么做的 （ jwt 相关）

该应用使用 NextAuth 进行用户认证。NextAuth 支持多种认证方式，包括基于 JWT（JSON Web Tokens）的认证和 OAuth（开放授权）等。在用户登录系统时，NextAuth 会在服务端验证用户的身份，并将生成的 JWT 令牌发送到客户端，之后，客户端可以利用这个令牌来进行受保护的操作。

## 说说 cookie 和 localstorage

Cookie 是由服务器发送到用户浏览器并保存在浏览器上的一种技术，主要用于在用户的电脑上保存少量信息。它的大小通常限制在 4KB 左右，而且有生命周期，过期后会被自动删除。每次当前用户向服务器发送请求时，都会自动携带这个 cookie。

localStorage 是 HTML5 新增的 API，它用于永久性地保存大量数据（最大存储量 5MB）在客户端。它并不会随着每次请求自动发送到服务器，适合保存仅供客户端使用的数据。

## 回到前面的问题，用户的登录状态是怎么存储在服务器端的（在 Redis 中用 HashMap，我滴汗，不是前端面试嘛）

在服务器端，你可以使用 Redis 这样的内存数据库来存储用户的 session，每个 session 对应一个 HashMap，里面存有用户的登录状态和其他需要的信息。当用户发来请求时，服务器根据请求中的 session ID 在 Redis 中查找相应的 session 数据，以此判断用户的登录状态。

## next auth 是怎么做身份校验的

NextAuth 提供了同时进行社交登录和基于 JWT 的认证的功能。在用户进行登录操作时，NextAuth 会根据用户的认证方式，生成一个包含用户信息的 JWT，存储在 Cookie 中，在用户之后的请求中，NextAuth 会验证这个 JWT 的合法性，从而确认用户的身份。

## 第三方授权的无限递归错误？

这种情况一般来说是因为存在反复重定向导致的，在用户进行第三方授权，比如使用 Google 或者 GitHub 登录的时候，如果授权成功后的回调 URL 配置不正确，可能会发生这样的问题。例如，你设置的回调 URL 又导向了开始的授权 URL，就会形成无限的递归导致错误。解决此问题，我们需要确保回调 URL 是导向我们自己的服务器，然后在服务器端正确处理第三方传回的授权信息。

## 第三方登录你是怎么做的，有做微信登陆嘛

第三方登录可以通过 OAuth 认证协议来实现。对于微信登录，先在微信开放平台注册开发者账户并创建应用，获取应用的 AppID 和 AppSecret，然后在你的应用中加入"微信登录"的按钮，当用户点击后，引导他们到微信的授权页面。用户同意授权后，微信会回调你在平台上设置的回调地址，同时给你一个授权码。你的服务器使用这个授权码，再加上你的 AppID 和 AppSecret，向微信服务器发起请求，获取 access_token 和用户的 openid，然后就可以获取到用户的微信信息了。

## 双 token 登陆有做过吗

双 token 登陆，就是指 access token 和 refresh token。access token 主要用于用户访问资源。但是访问令牌具有较短的生命周期，一旦过期，用户就需要重新登录。但是，为了更好的用户体验，这时候就可以使用 refresh token。用户在第一次登录成功后，服务端会返回一个 access token 和一个 refresh token。当 access token 过期时，用户可以使用 refresh token 向服务器请求新的 access token，从而无需重新登录。这种方式很常见于移动应用程序中。