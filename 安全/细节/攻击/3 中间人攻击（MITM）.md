**3 中间人攻击（MITM）**

​		中间人攻击本质上是窃听攻击。举个例子，小明用微信发一条消息给小红，这条消息会从小明的手机发送到微信的服务器，再由微信服务器转发给小红，理论上讲，微信服务器是可以查看或者修改小明发送的信息的。这个时候，微信服务器就可以是实施攻击的中间人。

​		攻击流程（Fiddler抓包为例）：

- 黑客通过特殊途径在被攻击者的手机上安装根证书；
- 客户端发起连接请求，代理服务器（Fiddler）在中间截取请求，返回自己签名的伪造证书；
- 客户端收到证书后会在系统中查找信任的根证书，因为黑客已经事先在被攻击者手机上安装了自己的根证书，因此客户端验证通过；
- 客户端后续就会把Fiddler当成合法的服务器；
- 而Fiddler会与真实的服务器通信，截获密钥，解密数据。

​		对https：

​		对于https来说，客户端或者操作系统内置了权威CA(certification authority)的根证书，而服务器在通信之初，会先返回在CA那里获取的签名证书，然后客户端用根证书验证证书有效性，最后使用验证通过的证书提供的公钥加密数据。前提假设是权威的证书机构不会把签名信息泄露出去。

​		早年12306非得使用自己签名的证书，而主流浏览器又不认可，导致用户需要在首次下载证书并安装。这其实是个很危险的操作，不法分子完全可以利用这个机制把非法证书安装到用户设备上。好在现在12306已经采用DigiCert颁布的证书了。