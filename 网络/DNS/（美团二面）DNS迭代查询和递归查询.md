## **递归查询与迭代查询**

一、主机向本地域名服务器的查询一般都是采用**递归查询**。

所谓递归查询就是：如果主机所询问的本地域名服务器不知道被查询的域名的 IP 地址，那么本地域名服务器就以 DNS 客户的身份，

向其它根域名服务器继续发出查询请求报文(即替主机继续查询)，而不是让主机自己进行下一步查询。

因此，递归查询返回的查询结果或者是所要查询的 IP 地址，或者是报错，表示无法查询到所需的 IP 地址。

二、本地域名服务器向根域名服务器的查询的**迭代查询**。

迭代查询的特点：当根域名服务器收到本地域名服务器发出的迭代查询请求报文时，要么给出所要查询的 IP 地址，要么告诉本地服务器：“你下一步应当向哪一个域名服务器进行查询”。

然后让本地服务器进行后续的查询。根域名服务器通常是把自己知道的顶级域名服务器的 IP 地址告诉本地域名服务器，让本地域名服务器再向顶级域名服务器查询。

顶级域名服务器在收到本地域名服务器的查询请求后，要么给出所要查询的 IP 地址，要么告诉本地服务器下一步应当向哪一个权限域名服务器进行查询。

最后，知道了所要解析的 IP 地址或报错，然后把这个结果返回给发起查询的主机

![](https://pic3.zhimg.com/80/v2-1962e4e6a09e63ece5542624d486f5ae_720w.webp)

![](https://pic1.zhimg.com/80/v2-ea2fa0f3bcb5b6ebbad37e810ecf8280_720w.webp)

**递归** ：客户端只发一次请求，要求对方给出最终结果。

**迭代** ：客户端发出一次请求，对方如果没有授权回答，它就会返回一个能解答这个查询的其它名称服务器列表，

客户端会再向返回的列表中发出请求，直到找到最终负责所查域名的名称服务器，从它得到最终结果。

**授权回答** ：向 dns 服务器查询一个域名，刚好这个域名是本服务器负责，返回的结果就是授权回答。

**从递归和迭代查询可以看出：**

**客户端-本地 dns 服务端：这部分属于递归查询。（定义）**

**本地 dns 服务端---外网：这部分属于迭代查询。**

**递归查询时，返回的结果只有两种:查询成功或查询失败.**

**迭代查询，又称作重指引,返回的是最佳的查询点或者主机地址.**
