# [浅谈Session与Cookie的关系](https://www.cnblogs.com/suguangti/p/11043039.html)

**一、概念理解：**

　　首先cookie是服务端识别客户的唯一标识的依据，客户在访问网站时候，服务端为了记住这个客户，会在服务端按照它的规则制作一个cookie数据，会将这个cookie数据保留在服务端一段时间，同时会给客户的一份它自己保留，这样就无需每次都要登录来认证自己了。　　

　　先来了解几个概念。

 　　1、**无状态的HTTP协议**：

　　协议是指计算机通信网络中两台计算机之间进行通信所必须共同遵守的规定或规则，超文本传输协议(HTTP)是一种通信协议，它允许将超文本标记语言(HTML)文档从Web服务器

　　传送到客户端的浏览器。

　　HTTP协议是无状态的协议。一旦数据交换完毕，客户端与服务器端的连接就会关闭，再次交换数据需要建立新的连接。**这
就意味着服务器无法从连接上跟踪会话**。

 　　**2、会话（Session）跟踪：**

　　会话，指用户登录网站后的一系列动作，比如浏览商品添加到购物车并购买。会话（Session）跟踪是Web程序中常用的技术，用来**跟踪用户的整个会话**。常用的会话跟踪技术

　　是Cookie与Session。**Cookie通过在客户端记录信息确定用户身份**，**Session通过****在服务器端记录信息确定
二、Cookie
　　由于HTTP是一种无状态的协议，服务器单从网络连接上无从知道客户身份。服务器要想识别每个客户端，怎么办，那就给每个访问我的用户的客户的一个通行证，这样服务器就能从通行证上确认客户身份了，这个通行证就是cookie的工作原理。
**

　　Cookie实际上是一小段的文本信息。客户端请求服务器，如果服务器需要记录该用户状态，就使用response向客户端浏览器颁发一个Cookie。客户端会把Cookie保存起来。

　　当浏览器再请求该网站时，浏览器把请求的网址连同该Cookie一同提交给服务器。服务器检查该Cookie，以此来辨认用户状态。服务器还可以根据需要修改Cookie的内容。

**1、cookie的内容主要包括：名字，值，过期时间，路径和域。路径与域一起构成cookie的作用范围。**

　　#Name 和 Value 属性由程序设定,默认值都是空引用。

　　#Domain属性的默认值为当前URL的域名部分，不管发出这个cookie的页面在哪个目录下的。

　　#Path属性的默认值是根目录，即 ”/” ，不管发出这个cookie的页面在哪个目录下的。可以由程序设置为一定的路径来进一步限制此cookie的作用范围。

　　#Expires 属性，这个属性设置此Cookie 的过期日期和时间。

**2、Path和Domain属性**

View Code

　　**Cookie具有不可跨域名性**

　　就是说，浏览器访问百度不会带上谷歌的cookie。

**三. Session**

　　**Session是另一种记录客户状态的机制，不同的是Cookie保存在客户端浏览器中，而Session保存在服务器上。客户端浏览器访问服务器的时候，服务器把客户端信息以某种形式记录**

　　在服务器上。这就是Session。客户端浏览器再次访问时只需要从该Session中查找该客户的状态就可以了。

 　 每个用户访问服务器都会建立一个session，那服务器是怎么标识用户的唯一身份呢？事实上，用户与服务器建立连接的同时，服务器会自动为其分配一个SessionId。

　　①**、我们需要知道：**

　　1）SessionId的重要性：
　　**什么东西可以让你每次请求都把SessionId自动带到服务器呢？显然就是cookie**了，如果你想为用户建立一次会话，可以在用户授权成功时给他一个唯一的cookie。当一个用户提交了表单时，浏览器会将用户的SessionId自动附加在HTTP头信息中，（这是浏览器的自动功能，用户不会察觉到），当服务器处理完这个表单后，将结果返回给SessionId所对应的用户。试想，如果没有 SessionId，当有两个用户同时进行注册时，服务器怎样才能知道到底是哪个用户提交了哪个表单呢。

　　2）储存需要的信息。服务器通过SessionId作为key，读写到对应的value，这就达到了保持会话信息的目的。
　　**②、session的创建：**

　　当程序需要为某个客户端的请求创建一个session时，服务器首先检查这个客户端的请求里是否已包含了sessionId，如果已包含则说明以前已经为此客户端创建过session，服务器就按照sessionId把这个session检索出来使用（检索不到，会新建一个），如果客户端请求不包含sessionId，则为此客户端创建一个session并且生成一个与此session相关联的sessionId，sessionId的值是一个既不会重复，又不容易被找到规律以仿造的字符串，这个sessionId将被在本次响应中返回给客户端保存。

　　**③、禁用cookie和session共享
**

View Code

**四、总结：**

**1、我们需要知道cookie在客户端，session在服务端，cookie的产生是在服务端产生的**

**2、cookie只是一个通行证，但并不是安全的，任何安全的校验必须要在服务端上完成，cookie只是存在客户端上面的一个唯一标识它且由服务端定制的信息，本地可以改，但是不管怎么改，最后还是需要把它拿上发送给服务端进行匹配校验**

**3、session和cookie的存储都存在时效性，这是很有必要的**

**4、单个cookie保存的数据不能超过4kb，很多浏览器都限制了一个站点最多保存20个cookie**

**5、不管是cookie还是session，都是建立在安全性的大前提下，session中不仅仅有cookie的信息，同时会有该用户的相关重要且安全的信息存储，所以session是在服务器的，而cookie只是服务器将一些不重要的信息拿出来丢给客户的存在，以备以后快速匹配校验用。**