## vite 和 webpack 的区别

要求涵盖这几点

> 详细讲了 webpack 和 vite 的区别，从 commonJs 到 es6 import 规范（不能回答得囫囵吞枣，含糊不清）
>
> commonJS怎么转esm
>
>  rollup打包产物和webpack打包产物在线上有什么区别

### 1 vite和webpack优缺点对比

* 更快的启动时间和更新速度
* 更好的开发体验：自动打开浏览器、自动刷新页面 配置简单。
* 不需要过多的配置就可以搭建基本的开发环境 更少的依赖。
* 借助原生的ES模块
* 避免了过多的额外依赖

&#x20;**缺点：**

* vite的构建技术主要用于中小型项目，对于大型项目的支持不如webpack&#x20;
* vite主要是针对vue3的单页面应用，对于多页面应用、ssr应用、自定义流程应用不如webpack&#x20;
* 开发环境首屏加载慢，懒加载慢&#x20;
  * vite由于基于原生ES模块，不支持commonJs；webpack关注兼容性，vite关注浏览器端的开发体验，vite的生态还不如webpack

### 2 webpack和vite的区别

Webpack 和 Vite 是两个用于模块打包和应用程序开发的工具，但在它们的底层实现和关注的领域上有一些区别。

1. 打包方式：
   - Webpack 使用了传统的模块打包，会预先进行一次完整的编译和打包操作，在开发模式下每次文件修改后都要去待编译的文件列表里面寻找依赖，可能会使得构建速度变慢。
   - Vite 则使用了一种被称作 "依赖预编译" 的新技术。当源代码需要被处理时（例如在开发服务器中请求某个模块），Vite 将会在后台动态地去编译这些代码。

2. 热更新：
   - Webpack 的热更新功能是通过 HMR（模块热更新）插件实现的，当文件内容改变时，通过 socket 通知浏览器端对相应的模块进行更新。
   - Vite 则利用了 **ES Module 的浏览器原生模块热更新特性**，每当文件发生改变时，只更新改变的文件，提高了热更新的性能。

3. 兼容性：
   - Webpack 兼容性更好，可以支持多种 JavaScript 版本和浏览器，而且插件众多，开发者可以根据需要进行选择。
   - Vite 则是为现代浏览器设计的，利用浏览器原生 ES modules 支持进行开发，所以在老版本浏览器上使用可能会有兼容性问题。

4. 体积和性能：
   - 由于 Webpack 的丰富功能和插件，它的体积相较于 Vite 会大一些，对内存和 CPU 资源的消耗更多。
   - Vite 更轻量，以优化的方式提供开发服务，可以大大提高开发效率和页面加载速度。

以上就是 Webpack 和 Vite 的一些主要区别，但是请根据项目的具体需求来选择最合适的工具。

### 3 为什么说vite比webpack更快？

1. webpack会先打包，然后启动开发服务器，请求服务器时直接给予打包结果。
2. vite是直接启动开发服务器，请求哪个模块再对该模块进行实时编译。
3. vite在启动的时候不需要打包，意味着不需要分析模块的依赖、不需要编译，因此启动速度非常快。
4. &#x20;当浏览器请求某个模块时，再根据需要对模块内容进行编译。这种按需动态编译的方式，极大的缩减了编译时间，项目越复杂、模块越多，vite的优势越明显。
5. &#x20;在HMR方面，当改动了一个模块后，仅需让浏览器重新请求该模块即可，不像webpack那样需要把该模块的相关依赖模块全部编译一次，效率更高。
6. &#x20;当需要打包到生产环境时，vite使用传统的rollup进行打包，因此，vite的主要优势在开发阶段。另外，由于vite利用的是ES Module，因此在代码中不可以使用CommonJS

