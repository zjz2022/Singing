## http协议报文格式，http1.0、1.1、2.0、3.0（小林coding）

**解析**

> 属于高频考题：自产自产《[大厂后端Top100面试题讲解](https://mp.weixin.qq.com/s?__biz=Mzk0OTM5MDMzNg==&mid=2247483813&idx=1&sn=d76cd77235886194667bb81cd1920b64&scene=21#wechat_redirect)》｜第90，97，98，99题
>
> 所属专项：计算机网络｜HTTP
>
> 专项考察占比：
>
> 【**计算机网络**】面试中考察计算机网络的比率：[大厂：11%](https://mp.weixin.qq.com/s?__biz=Mzk0OTM5MDMzNg==&mid=2247483843&idx=1&sn=7c7bd2c6b906c0ab38c868b84b88da56&chksm=c3585cacf42fd5ba38542da8ac77a7e731b486243c4aaf249d46d91b6c5e0e4e945f9729ad98&token=1036259463&lang=zh_CN&scene=21#wechat_redirect)｜ [腾讯：17%](https://mp.weixin.qq.com/s?__biz=Mzk0OTM5MDMzNg==&mid=2247483854&idx=1&sn=668db515e36dcdc8c180b11abef66e72&chksm=c3585ca1f42fd5b7d399b32a3c909b61a16f13c3bdb6ef6e0461470acdd3955c33a8a0d46120&token=1036259463&lang=zh_CN&scene=21#wechat_redirect)｜ [阿里：7%](https://mp.weixin.qq.com/s?__biz=Mzk0OTM5MDMzNg==&mid=2247483854&idx=1&sn=668db515e36dcdc8c180b11abef66e72&chksm=c3585ca1f42fd5b7d399b32a3c909b61a16f13c3bdb6ef6e0461470acdd3955c33a8a0d46120&token=1036259463&lang=zh_CN&scene=21#wechat_redirect)
>
> 【**计算机网络-HTTP**】面试考察计网时问HTTP问题的比率：[35%](https://mp.weixin.qq.com/s?__biz=Mzk0OTM5MDMzNg==&mid=2247483843&idx=1&sn=7c7bd2c6b906c0ab38c868b84b88da56&chksm=c3585cacf42fd5ba38542da8ac77a7e731b486243c4aaf249d46d91b6c5e0e4e945f9729ad98&token=1036259463&lang=zh_CN&scene=21#wechat_redirect)

### http协议的报文结构？

- 首先，HTTP请求报文主要由请求行、请求头部和请求体三个部分构成。请求行包含了请求的方法，比如GET或POST，请求的URL路径，以及HTTP协议的版本。紧接着请求行的是请求头部，它由多个键值对组成，每个键值对代表一种信息或设置，比如Host字段标明请求的目标主机，User-Agent字段描述发出请求的用户代理信息，Accept字段则列出客户端能够理解的内容类型。请求头部之后，可能跟随一个请求体，它通常用于POST或PUT请求中，包含客户端提交给服务器的数据。
- 其次，HTTP响应报文的结构与请求报文相似，由状态行、响应头部和响应体组成。状态行包含HTTP协议版本、状态码以及状态描述信息。比如，状态码200表示请求成功，404则表示资源未找到。响应头部也包含多个键值对，提供有关响应的附加信息，如Content-Type描述响应体的内容类型，Content-Length指明响应体的长度。响应体则包含服务器返回给客户端的实际数据内容，如HTML文件、图片或其他媒体资源。

### HTTP/1.1相对HTTP/1.0做了哪些优化改进？

首先，HTTP/1.1引入了持久连接的概念，也就是所谓的**长连接**。在HTTP/1.0中，每次请求都需要建立一个新的TCP连接，请求处理完毕后立即断开连接。这种方式在处理包含大量图片、链接等资源时，会导致大量的连接建立和断开操作，造成资源浪费和时间延迟。而HTTP/1.1则允许在同一个TCP连接上连续发送多个请求，从而减少了连接建立和断开的开销，提高了网络资源的利用率。

其次，HTTP/1.1支持**请求管道化**，这意味着客户端可以同时发送多个请求，而不需要等待前一个请求的响应。这样，服务器就可以按照请求到达的顺序依次进行回应，从而减少了等待时间，提高了整体的响应速度。需要注意的是，虽然请求管道化可以并行发送请求，但服务器仍然需要按照顺序回应。

另外，HTTP/1.1还增加了更多的**错误**状态码，提供了更详细的错误信息，这有助于开发人员更好地定位问题并进行调试。同时，HTTP/1.1还引入了更多的请求头和响应头，为开发人员提供了更多的控制和灵活性。

最后，值得一提的是，HTTP/1.1还改进了**缓存机制**，允许服务器发送“Last-Modified”和“ETag”等响应头，以便客户端进行条件性请求，这避免了不必要的资源传输，提高了网络的利用率。

总的来说，HTTP/1.1相对于HTTP/1.0在连接管理、请求管道化、错误处理、缓存机制等方面都做了显著的优化和改进，从而提高了网络应用的性能和效率。

1. HTTP/2.0相对HTTP/1.1做了哪些优化改进？

HTTP/2.0在保持与HTTP/1.1的语义兼容性的同时，引入了多项重大改进，显著提升了网络性能。

首先，HTTP/2.0采用了二进制分帧层，这使得客户端和服务器可以将HTTP消息分解为多个互不依赖的帧，并可以乱序发送。这些帧在另一端被重新组合起来，从而实现了低延迟和高吞吐量。

其次，HTTP/2.0引入了多路复用技术，允许同时通过单一的HTTP/2连接发起多重请求-响应消息。这解决了HTTP/1.1中的队头阻塞问题，使得多个数据流可以并行传输，从而更有效地使用TCP连接，提高了网络资源的利用率。

此外，HTTP/2.0还支持头部压缩，通过HPACK算法对请求头进行压缩传输，节省了消息头占用的网络流量，降低了带宽消耗。

最后，HTTP/2.0还引入了服务器推送技术，即服务器可以对一个请求发送多个响应。这种机制使得服务器能够更快地推送资源到客户端，从而提高了页面加载速度。

综上所述，HTTP/2.0通过二进制分帧、多路复用、头部压缩和服务器推送等技术，显著提升了网络性能，降低了网络延迟，为用户提供了更好的网络体验。

### HTTP/3.0相对HTTP/2.0做了哪些优化改进？

首先，HTTP/3.0使用了基于UDP协议的QUIC作为传输层协议，而不是传统的TCP协议。这一改变显著减少了连接建立的延迟，因为QUIC协议在建立连接时无需进行多次握手，从而加速了数据传输的速度。

其次，HTTP/3.0支持真正的多路复用，这意味着在同一连接上可以并行处理多个请求和响应，而不会像HTTP/2那样存在队头阻塞的问题。这大大提高了网络资源的利用率和传输效率。

此外，HTTP/3.0还具备更好的流量控制能力，可以有效防止单一流的资源占用过多带宽，从而保证网络传输的稳定性和公平性。

在安全性方面，HTTP/3.0默认使用TLS 1.3加密，为数据传输提供了更高的安全性。同时，QUIC协议还提供了更好的错误恢复机制，当数据包丢失或损坏时，能够更快速地恢复连接并进行数据传输。

最后，值得一提的是，HTTP/3.0还支持0-RTT连接，即客户端可以在不需要等待服务器响应的情况下直接发送数据给服务器。这种连接方式可以大幅度缩短连接建立时间，但在某些场景下可能存在一定的安全风险，因此在使用时需要谨慎考虑。

总的来说，HTTP/3.0通过采用QUIC协议、支持真正的多路复用、提供更好的流量控制和安全性能等方面的优化和改进，进一步提升了网络传输的效率和性能。这些改进使得HTTP/3.0成为现代网络中更具优势和应用前景的协议。

**推荐学习资料：**

- 《博客：JavaScript Guidebook》：HTTP 报文格式
- 《小林Coding》｜图解网络：HTTP/1.1 相比 HTTP/1.0 提高了什么性能？
- 《小林Coding》｜图解网络：HTTP/2 做了什么优化？
- 《小林Coding》｜图解网络：HTTP/3 做了什么优化？